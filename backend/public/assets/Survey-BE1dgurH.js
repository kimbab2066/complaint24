import{B as Y,G as H,e as v,o as d,n as Z,m as ee,X as w,as as Q,p as e,F as A,a4 as F,t as T,ax as X,g as l,d as P,f as q,w as g,aJ as i,a3 as D,q as te,bk as O,D as C,aF as k,aN as le,a1 as z,a2 as se,aD as ae}from"./index-CIvZqnG9.js";import{a as G,b as J,s as K}from"./index-Bzi9e_JM.js";import{s as oe}from"./index-Qd62vs18.js";import{s as L}from"./index-CVVAIkGy.js";import{s as I}from"./index-Q5f-HasL.js";import{s as B}from"./index-DaQCVIMN.js";import{s as N}from"./index-CS-xok40.js";import{s as ne}from"./index-Cq2nnSLM.js";import{_ as re}from"./SupportPlanItem-Bx3Ij0N3.js";import{s as ue,a as j}from"./index-DFkLlqX2.js";import{s as ie}from"./index-D2nFSbvD.js";import{s as de}from"./index-D3alGoI6.js";import{s as E}from"./index-V3FZzHdg.js";import"./index-D2qeKuO0.js";import"./index-ntJNSm1c.js";import"./index-B8K14yKN.js";import"./index-rSX_qRTu.js";import"./index-DtbhESyl.js";import"./index-DrWbS65R.js";import"./index-CI70ECEq.js";import"./index-CDHacQLo.js";import"./index-vf1YAX2A.js";import"./index-DRZUHWhE.js";import"./index-m-AAtQFb.js";import"./index-2HQD3IZ5.js";import"./index-D5j367Ho.js";import"./index-C8f_UxCN.js";var pe={root:"p-tabpanels"},ce=Y.extend({name:"tabpanels",classes:pe}),ve={name:"BaseTabPanels",extends:H,props:{},style:ce,provide:function(){return{$pcTabPanels:this,$parentInstance:this}}},W={name:"TabPanels",extends:ve,inheritAttrs:!1};function me(_,x,a,t,r,c){return d(),v("div",ee({class:_.cx("root"),role:"presentation"},_.ptmi("root")),[Z(_.$slots,"default")],16)}W.render=me;const fe={class:"card p-3 rounded-xl bg-white border border-gray-100 transition duration-300"},ye={key:0,class:"text-center p-6 text-gray-500"},_e={key:1,class:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-y-3 gap-x-4"},xe={class:"text-gray-600 font-bold text-xs uppercase tracking-wider mb-0.5"},ge={class:"text-gray-800 text-xs break-words"},we={__name:"ApplicantInfo",props:{wardId:{type:[String,Number],default:null},applicantData:{type:Object,default:()=>null}},setup(_){const x=_,a=w({ì´ë¦„:"...",ë‚˜ì´:"...",ì„±ë³„:"...",ìƒë…„ì›”ì¼:"...",ìž¥ì• ìœ í˜•:"...",ì£¼ì†Œ:"..."});return Q(()=>x.applicantData,t=>{t&&(a.value={ì´ë¦„:t.ì´ë¦„||"ì •ë³´ ì—†ìŒ",ë‚˜ì´:t.ë‚˜ì´?`${t.ë‚˜ì´}ì„¸`:"ì •ë³´ ì—†ìŒ",ì„±ë³„:t.ì„±ë³„||"ì •ë³´ ì—†ìŒ",ìƒë…„ì›”ì¼:t.ìƒë…„ì›”ì¼||"ì •ë³´ ì—†ìŒ",ìž¥ì• ìœ í˜•:t.ìž¥ì• ìœ í˜•||"ì—†ìŒ",ì£¼ì†Œ:t.ì£¼ì†Œ||"ì •ë³´ ì—†ìŒ"})},{immediate:!0}),(t,r)=>(d(),v("div",fe,[r[0]||(r[0]=e("div",{class:"text-lg mb-3 text-indigo-700 border-b pb-2"},"ì§€ì›ìž ìƒì„¸ ì •ë³´",-1)),x.applicantData?(d(),v("div",_e,[(d(!0),v(A,null,F(a.value,(c,b)=>(d(),v("div",{key:b,class:"flex flex-col p-2 bg-gray-50 rounded-lg border border-gray-200"},[e("span",xe,T(b),1),e("span",ge,T(c),1)]))),128))])):(d(),v("div",ye," ìƒìœ„ ë°ì´í„° ë¡œë“œ ëŒ€ê¸° ì¤‘... "))]))}},be={class:"flex flex-col gap-8"},$e={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},he={class:"flex flex-col gap-3"},Ve={class:"flex flex-col gap-3"},Se={class:"flex flex-col gap-3"},ke={class:"flex flex-col gap-3"},Ce={class:"flex flex-col gap-6"},Ie={class:"flex flex-col gap-3"},qe={class:"flex flex-col gap-3"},Ue={class:"flex flex-col gap-6"},Te=["for"],De={key:1,class:"flex items-center gap-6"},Ae={class:"flex items-center"},Fe=["for"],Le={class:"flex items-center"},Ne=["for"],Pe={class:"flex flex-col gap-3"},Re={__name:"SurveyDetailForm",props:{inquiryDetail:{type:Object,required:!0},questions:{type:Array,required:!0},editMode:{type:Boolean,default:!1},modificationReason:{type:String,required:!0},surveyPurpose:{type:String,required:!0},surveyContent:{type:String,required:!0}},emits:["update:modificationReason","update:surveyPurpose","update:surveyContent"],setup(_){return(x,a)=>(d(),v("div",be,[l(i(L),null,{title:g(()=>[...a[3]||(a[3]=[e("div",{class:"font-semibold text-xl"},"ì¡°ì‚¬ì§€ ê¸°ë³¸ ì •ë³´",-1)])]),content:g(()=>[e("div",$e,[e("div",he,[a[4]||(a[4]=e("label",null,"ì¡°ì‚¬ì§€ëª…",-1)),l(i(I),{type:"text",value:_.inquiryDetail.inquiry_name,disabled:""},null,8,["value"])]),e("div",Ve,[a[5]||(a[5]=e("label",null,"ì‚¬ì—…ëª…",-1)),l(i(I),{type:"text",value:_.inquiryDetail.business_name||"ë¬¸ì˜ì¡°ì‚¬",disabled:""},null,8,["value"])]),e("div",Se,[a[6]||(a[6]=e("label",null,"ìž‘ì„±ìž",-1)),l(i(I),{type:"text",value:_.inquiryDetail.inquiry_writer,disabled:""},null,8,["value"])]),e("div",ke,[a[7]||(a[7]=e("label",null,"ìž‘ì„±ì¼",-1)),l(i(I),{type:"text",value:_.inquiryDetail.created_at,disabled:""},null,8,["value"])])])]),_:1}),l(i(L),null,{title:g(()=>[...a[8]||(a[8]=[e("div",{class:"font-semibold text-xl"},"ì¡°ì‚¬ ëª©ì  ë° ë‚´ìš©",-1)])]),content:g(()=>[e("div",Ce,[e("div",Ie,[a[9]||(a[9]=e("label",null,"ëª©ì ",-1)),l(i(I),{value:_.surveyPurpose,"onUpdate:modelValue":a[0]||(a[0]=t=>x.$emit("update:surveyPurpose",t)),placeholder:"ì¡°ì‚¬ ëª©ì ì„ ìž…ë ¥í•˜ì„¸ìš”..."},null,8,["value"])]),e("div",qe,[a[10]||(a[10]=e("label",null,"ë‚´ìš©",-1)),l(i(N),{"model-value":_.surveyContent,"onUpdate:modelValue":a[1]||(a[1]=t=>x.$emit("update:surveyContent",t)),rows:"3",placeholder:"ì¡°ì‚¬ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”..."},null,8,["model-value"])])])]),_:1}),l(i(L),null,{title:g(()=>[...a[11]||(a[11]=[e("div",{class:"font-semibold text-xl"},"ì§ˆë¬¸ ë° ë‹µë³€",-1)])]),content:g(()=>[e("div",Ue,[(d(!0),v(A,null,F(_.questions,(t,r)=>(d(),v("div",{key:t.id,class:"flex flex-col gap-3"},[e("label",{for:"question-"+r,class:"font-medium"},[D(" ì§ˆë¬¸ "+T(r+1)+". "+T(t.text)+" ",1),t.priority?(d(),v("span",{key:0,class:te([{"priority-urgent":t.priority==="ê¸´ê¸‰","priority-important":t.priority==="ì¤‘ì ","priority-plan":t.priority==="ê³„íš"},"ml-2 px-2 py-1 rounded-md text-xs font-semibold"])},T(t.priority),3)):q("",!0)],8,Te),t.response_type===1?(d(),P(i(N),{key:0,id:"question-"+r,modelValue:t.answer,"onUpdate:modelValue":c=>t.answer=c,rows:"4",placeholder:"ë‹µë³€ì„ ìž…ë ¥í•˜ì„¸ìš”..."},null,8,["id","modelValue","onUpdate:modelValue"])):t.response_type===2?(d(),v("div",De,[e("div",Ae,[l(i(B),{inputId:"question-o-"+r,name:"question-"+r,value:"O",modelValue:t.answer,"onUpdate:modelValue":c=>t.answer=c},null,8,["inputId","name","modelValue","onUpdate:modelValue"]),e("label",{for:"question-o-"+r,class:"ml-2"},"O",8,Fe)]),e("div",Le,[l(i(B),{inputId:"question-x-"+r,name:"question-"+r,value:"X",modelValue:t.answer,"onUpdate:modelValue":c=>t.answer=c},null,8,["inputId","name","modelValue","onUpdate:modelValue"]),e("label",{for:"question-x-"+r,class:"ml-2"},"X",8,Ne)])])):q("",!0)]))),128))])]),_:1}),_.editMode?(d(),P(i(L),{key:0},{title:g(()=>[...a[12]||(a[12]=[e("div",{class:"font-semibold text-xl"},"ìˆ˜ì • ì‚¬ìœ ",-1)])]),content:g(()=>[e("div",Pe,[l(i(N),{"model-value":_.modificationReason,"onUpdate:modelValue":a[2]||(a[2]=t=>x.$emit("update:modificationReason",t)),rows:"3",placeholder:"ìˆ˜ì • ì‚¬ìœ ë¥¼ ìž…ë ¥í•˜ì„¸ìš”...",class:"w-full"},null,8,["model-value"])])]),_:1})):q("",!0)]))}},Oe=X(Re,[["__scopeId","data-v-0c45c4ef"]]),Me={key:0,class:"flex justify-center items-center h-64"},Be={key:1},je={key:2},Ee={class:"flex justify-end gap-2 mt-8"},Qe={__name:"SurveyDetail",props:{inquiryId:{type:[Number,String],required:!0}},setup(_){const x=_,a=w(null),t=w([]),r=w(!0),c=w(null),b=w(!1),$=w(null),V=w(""),S=w(""),y=w(""),o=async s=>{if(s){r.value=!0,c.value=null,b.value=!1,$.value=null,V.value="",S.value="",y.value="";try{const m=await k.get(`/api/user/user-inquiries/${s}`);if(a.value=m.data.result,!a.value)throw new Error("Inquiry not found.");a.value.inquiry_writer="test";const p=await k.get(`/api/user/user-inquiries/${s}/questions`),h=await k.post("/api/user/survey-by-inquiry-content",{inquiryName:a.value.inquiry_name});let R=new Map;h.data.result&&(b.value=!0,$.value=h.data.result,V.value=$.value.modify_reason||"",S.value=$.value.purpose||"",y.value=$.value.content||"",(await k.get(`/api/user/survey-results/${$.value.survey_no}`)).data.result.forEach(M=>{R.set(M.business_no,M.survey_answer)})),t.value=p.data.result.map(U=>({id:U.question_no,text:U.question_content,answer:R.get(U.question_no)||"",response_type:U.response_type,is_required:U.is_required,priority:U.priority}))}catch(m){console.error("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:",m),c.value="ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}finally{r.value=!1}}};Q(()=>x.inquiryId,s=>{o(s)},{immediate:!0});const u=O(()=>{const s=t.value.some(m=>m.is_required===1&&(m.answer===null||m.answer.toString().trim()===""));return b.value?s||V.value.trim()==="":s}),f=async()=>{try{const s=t.value.map(h=>({business_no:h.id,survey_answer:h.answer})),m={...a.value};m.writer="test",m.ward_no=1,m.purpose=S.value,m.content=y.value,m.status="ì ‘ìˆ˜";const p={inquiryDetail:m,answers:s};await k.post("/api/user/user-inquiries/answer",p),alert("ë‚´ìš©ì´ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤."),o(x.inquiryId)}catch(s){console.error("ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:",s),alert("ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},n=async()=>{if(!$.value){alert("ì˜¤ë¥˜: ìˆ˜ì •í•  ì„¤ë¬¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}try{const m={answers:t.value.map(p=>({business_no:p.id,survey_answer:p.answer})),modificationReason:V.value,purpose:S.value,content:y.value};await k.put(`/api/user/survey-results/${$.value.survey_no}`,m),alert("ë‚´ìš©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."),o(x.inquiryId)}catch(s){console.error("ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:",s),alert("ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}};return(s,m)=>(d(),v("div",null,[r.value?(d(),v("div",Me,[l(i(ne))])):c.value?(d(),v("div",Be,[l(i(L),null,{title:g(()=>[...m[3]||(m[3]=[D("ì˜¤ë¥˜",-1)])]),content:g(()=>[e("p",null,T(c.value),1)]),_:1})])):a.value?(d(),v("div",je,[l(Oe,{"inquiry-detail":a.value,questions:t.value,"edit-mode":b.value,"modification-reason":V.value,"onUpdate:modificationReason":m[0]||(m[0]=p=>V.value=p),"survey-purpose":S.value,"onUpdate:surveyPurpose":m[1]||(m[1]=p=>S.value=p),"survey-content":y.value,"onUpdate:surveyContent":m[2]||(m[2]=p=>y.value=p)},null,8,["inquiry-detail","questions","edit-mode","modification-reason","survey-purpose","survey-content"]),e("div",Ee,[b.value?q("",!0):(d(),P(i(C),{key:0,label:"ì €ìž¥",onClick:f,disabled:u.value},null,8,["disabled"])),b.value?(d(),P(i(C),{key:1,label:"ìˆ˜ì •",onClick:n,disabled:u.value},null,8,["disabled"])):q("",!0)])])):q("",!0)]))}},Xe={class:"card"},ze={class:"p-input-icon-left w-full mb-4"},Ge={key:0,class:"flex flex-col gap-4"},Je={key:1,class:"text-center p-6 text-lg text-gray-500"},Ke={__name:"SupportList",props:["ward-id"],setup(_){const x=w(!1),a=w([]),t=w(!1),r=w(""),c=w(null);console.log(_);const $=y=>{switch(y){case 1:return"ê¸´ê¸‰";case 2:return"ì¤‘ì ";case 3:return"ì¤€ë¹„";default:return"ì¤€ë¹„"}},V=y=>{x.value||(c.value=c.value===y?null:y)};le(async()=>{t.value=!0;try{const y=await k.get("/api/staff/support-plan");a.value=y.data.map(o=>({support_plan_no:o.support_plan_no,support_plan_goal:o.support_plan_goal||"",staff_name:o.staff_name||"",created_at:o.created_at?o.created_at.split("T")[0]:"",writer_date:o.writer_date?o.writer_date.split("T")[0]:"",priority_no:o.priority_no,priority:$(o.priority_no),business_name:o.business_name||"",spend:o.spend||0,plan:o.plan||"",file_names:o.file_names||"",support_plan_status:o.support_plan_status||o.status||""}))}catch(y){console.error("Support Plan ì¡°íšŒ ì˜¤ë¥˜:",y)}finally{t.value=!1}});const S=O(()=>{if(!r.value)return a.value;const y=r.value.toLowerCase();return a.value.filter(o=>o.support_plan_goal.toLowerCase().includes(y)||o.staff_name.toLowerCase().includes(y)||o.priority.toLowerCase().includes(y))});return(y,o)=>(d(),v("div",Xe,[e("div",ze,[o[1]||(o[1]=e("i",{class:"pi pi-search"},null,-1)),l(i(I),{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=u=>r.value=u),placeholder:"ì§€ì›ì œëª©, ìž‘ì„±ìž, ìš°ì„ ìˆœìœ„ ë“±ìœ¼ë¡œ ê²€ìƒ‰",class:"w-full p-inputtext-lg"},null,8,["modelValue"])]),t.value?(d(),v("div",Je,"ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...")):(d(),v("div",Ge,[(d(!0),v(A,null,F(S.value,u=>(d(),P(re,{key:u.support_plan_no,item:u,"is-active":c.value===u.support_plan_no,"allow-multiple":x.value,onToggleDetail:()=>V(u.support_plan_no)},null,8,["item","is-active","allow-multiple","onToggleDetail"]))),128))]))]))}},We={class:"card"},Ye={class:"flex flex-col gap-4"},He={class:"border-b pb-4 mb-4"},Ze={key:0},et={key:1,class:"text-center text-gray-500 p-8 border rounded-md"},tt={__name:"SelectCategory",props:["ward-id"],setup(_){const x=w("0"),a=w([]),t=w(null),r=w(!1),c=w(!0);console.log(_);const $=async()=>{c.value=!0;try{const y=await k.get("/api/user/my-page-surveys",{params:{writer:"test"}});a.value=y.data.result}catch(y){console.error("Failed to fetch survey list:",y)}finally{c.value=!1}};z(()=>{$()});const V=()=>{r.value=!0},S=y=>{t.value=y.data.inquiry_no,r.value=!1};return(y,o)=>{const u=J,f=G,n=oe,s=W,m=K;return d(),v("div",We,[l(m,{value:x.value,"onUpdate:value":o[0]||(o[0]=p=>x.value=p)},{default:g(()=>[l(f,null,{default:g(()=>[l(u,{value:"0"},{default:g(()=>[...o[2]||(o[2]=[D("ì§€ì›ì‹ ì²­ì„œ",-1)])]),_:1}),l(u,{value:"1"},{default:g(()=>[...o[3]||(o[3]=[D("ì§€ì›ê³„íšì„œ",-1)])]),_:1}),l(u,{value:"2"},{default:g(()=>[...o[4]||(o[4]=[D("ì§€ì›ê²°ê³¼ì„œ",-1)])]),_:1})]),_:1}),l(s,null,{default:g(()=>[l(n,{value:"0",class:"p-4"},{default:g(()=>[e("div",Ye,[e("div",He,[l(i(C),{label:"ìž‘ì„±í•œ ì¡°ì‚¬ì§€ ëª©ë¡ ë³´ê¸°",icon:"pi pi-list",onClick:V})]),t.value?(d(),v("div",Ze,[l(Qe,{"inquiry-id":t.value},null,8,["inquiry-id"])])):(d(),v("div",et,[...o[5]||(o[5]=[e("p",null,"ì¡°ì‚¬ì§€ ëª©ë¡ ë³´ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìž‘ì„± ë˜ëŠ” ìˆ˜ì •í•  ì¡°ì‚¬ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”.",-1)])]))])]),_:1}),l(n,{value:"1",class:"p-4"},{default:g(()=>[l(Ke,{"ward-id":y.wardId},null,8,["ward-id"])]),_:1}),l(n,{value:"2"},{default:g(()=>[...o[6]||(o[6]=[e("div",{class:"p-4"},[e("h3",{class:"text-xl font-semibold"},"ì§€ì›ê²°ê³¼ì„œ"),e("p",null,"ì§€ì›ê²°ê³¼ì„œ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.")],-1)])]),_:1})]),_:1})]),_:1},8,["value"]),l(i(se),{header:"ì¡°ì‚¬ì§€ ëª©ë¡",visible:r.value,"onUpdate:visible":o[1]||(o[1]=p=>r.value=p),modal:"",style:{width:"50vw"}},{default:g(()=>[l(i(ue),{value:a.value,loading:c.value,"selection-mode":"single",onRowSelect:S,"data-key":"inquiry_no","responsive-layout":"scroll"},{default:g(()=>[l(i(j),{field:"content",header:"ì¡°ì‚¬ì§€ëª…"}),l(i(j),{field:"created_at",header:"ìž‘ì„±ì¼"})]),_:1},8,["value","loading"])]),_:1},8,["visible"])])}}},lt={class:"md:1"},st={class:"card flex flex-col gap-4 w-full border p-4 rounded-md shadow-sm"},at={class:"flex flex-col md:flex-row gap-2 mt-2"},ot={class:"flex flex-wrap gap-2 w-full"},nt={class:"flex flex-col md:flex-row gap-4"},rt={class:"flex flex-wrap gap-2 w-full"},ut={class:"flex flex-wrap"},it={class:"mt-6 border-t pt-4"},dt={class:"flex flex-col gap-2"},pt=["onChange"],ct={key:0,class:"list-disc ml-5 text-sm text-gray-600"},vt={class:"flex justify-end gap-3 mt-6 border-t pt-4"},mt={class:"flex justify-end mt-4"},ft={__name:"ApplicationPlanForm",props:{wardId:{type:[String,Number],required:!1}},setup(_){const x=ae(),a=O(()=>{var n;return(n=x.user)==null?void 0:n.name}),t=_;let r=0;const c=()=>({id:r++,writer:"",staff:"",dropdownItem:null,amount:"",plan:"",selectedFiles:[],priority:null}),b=w([c()]),$=w([{name:"1ë²ˆ ì‚¬ì—…",code:"Option 1"},{name:"2ë²ˆ ì‚¬ì—…",code:"Option 2"},{name:"3ë²ˆ ì‚¬ì—…",code:"Option 3"},{name:"4ë²ˆ ì‚¬ì—…",code:"Option 4"},{name:"5ë²ˆ ì‚¬ì—…",code:"Option 5"},{name:"6ë²ˆ ì‚¬ì—…",code:"Option 6"}]),V=n=>{const s=n.amount.replace(/[^0-9]/g,"");n.amount=s?Number(s).toLocaleString():""},S=(n,s)=>{s.selectedFiles=Array.from(n.target.files)},y=async n=>{var s,m;if(!n.writer||!n.dropdownItem||!n.plan){alert("í•„ìˆ˜ í•­ëª©(ëª©í‘œ, ì‚¬ì—…, ë‚´ìš©)ì„ ëª¨ë‘ ìž…ë ¥í•´ì£¼ì„¸ìš”.");return}if(!t.wardId){alert("í”¼ë³´í˜¸ìž ì •ë³´ê°€ ì•„ì§ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");return}try{const p={ward_no:Number(t.wardId),support_plan_goal:n.writer,plan:n.plan,business_name:((s=n.dropdownItem)==null?void 0:s.name)||null,spend:parseInt(n.amount.replace(/,/g,""))||0,file_no:"1",support_plan_status:"ìŠ¹ì¸ëŒ€ê¸°",staff_name:a.value};console.log("payload:",p),await k.post("/api/staff/support-plan",p),alert(`í¼ ${n.id} ìŠ¹ì¸ìš”ì²­ ì™„ë£Œ!`),b.value=[c()]}catch(p){console.error("ìŠ¹ì¸ìš”ì²­ ì˜¤ë¥˜:",((m=p.response)==null?void 0:m.data)||p),alert("ìŠ¹ì¸ìš”ì²­ ì‹¤íŒ¨. ì„œë²„ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.")}},o=n=>alert(`í¼ ${n.id} ìž„ì‹œì €ìž¥ ì™„ë£Œ!`),u=n=>{confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(b.value=b.value.filter(s=>s.id!==n))},f=()=>b.value.push(c());return(n,s)=>{const m=ie;return d(),v("div",lt,[s[5]||(s[5]=e("h1",{class:"text-3xl font-extrabold mb-8 text-gray-800 border-b-4 border-indigo-300 pb-2"}," ðŸ“ ì§€ì› ê³„íš ìž‘ì„± ",-1)),l(m,null,{default:g(()=>[(d(!0),v(A,null,F(b.value,p=>(d(),v("div",{key:p.id,class:"flex mt-8"},[e("div",st,[e("div",at,[e("div",ot,[s[0]||(s[0]=e("label",null,"ëª©í‘œ",-1)),l(i(I),{modelValue:p.writer,"onUpdate:modelValue":h=>p.writer=h,type:"text"},null,8,["modelValue","onUpdate:modelValue"])])]),e("div",nt,[e("div",rt,[s[1]||(s[1]=e("label",null,"ì§€ì›ê³„íš",-1)),l(i(de),{modelValue:p.dropdownItem,"onUpdate:modelValue":h=>p.dropdownItem=h,options:$.value,optionLabel:"name",placeholder:"Select One",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"]),s[2]||(s[2]=e("label",null,"ì˜ˆìƒì§€ì›ê¸ˆì•¡",-1)),l(i(I),{modelValue:p.amount,"onUpdate:modelValue":h=>p.amount=h,type:"text",class:"text-right",placeholder:"ì˜ˆ: 50,000",onInput:h=>V(p)},null,8,["modelValue","onUpdate:modelValue","onInput"])])]),e("div",ut,[s[3]||(s[3]=e("label",null,"ë‚´ìš©",-1)),l(i(N),{modelValue:p.plan,"onUpdate:modelValue":h=>p.plan=h,rows:"4"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",it,[s[4]||(s[4]=e("h6",null,"PDF ì—…ë¡œë“œ",-1)),e("form",dt,[(d(),v("input",{key:p.id,type:"file",name:"pdfFiles",accept:".pdf",multiple:"",class:"border p-2 rounded",onChange:h=>S(h,p)},null,40,pt)),p.selectedFiles.length?(d(),v("ul",ct,[(d(!0),v(A,null,F(p.selectedFiles,(h,R)=>(d(),v("li",{key:R},T(h.name),1))),128))])):q("",!0)])]),e("div",vt,[l(i(C),{label:"ìž„ì‹œì €ìž¥",icon:"pi pi-save",severity:"secondary",onClick:()=>o(p)},null,8,["onClick"]),l(i(C),{label:"ì‚­ì œ",icon:"pi pi-trash",severity:"danger",onClick:()=>u(p.id)},null,8,["onClick"]),l(i(C),{label:"ìŠ¹ì¸ìš”ì²­",icon:"pi pi-send",severity:"success",onClick:()=>y(p)},null,8,["onClick"])])])]))),128)),e("div",mt,[l(i(C),{label:"ì¶”ê°€",icon:"pi pi-plus",severity:"info",onClick:f})])]),_:1})])}}},yt={class:"md:1 p-4"},_t={class:"space-y-8"},xt={class:"flex flex-col gap-2"},gt={class:"flex flex-col gap-2 w-full"},wt={class:"flex flex-col md:flex-row gap-2"},bt={class:"flex flex-col gap-2 w-full md:w-1/2"},$t={class:"flex flex-col gap-2 w-full md:w-1/2"},ht={class:"flex flex-col gap-2"},Vt={class:"flex justify-end gap-3 mt-4 border-t pt-4"},St={class:"flex justify-end mt-4"},kt={__name:"ActivityReport",setup(_){let x=0;const a=()=>({id:x++,supportTitle:"",supportSpend:"",supportContent:"",startedAt:null,endedAt:null}),t=w([a()]),r=u=>{const f=u.supportSpend.replace(/[^0-9]/g,"");u.supportSpend=f?Number(f).toLocaleString():""},c=u=>{if(!u)return null;const f=new Date(u),n=f.getFullYear(),s=String(f.getMonth()+1).padStart(2,"0"),m=String(f.getDate()).padStart(2,"0");return`${n}-${s}-${m} 00:00:00`},b=u=>({support_title:u.supportTitle,support_content:u.supportContent||null,support_spend:Number(u.supportSpend.replace(/[^0-9]/g,""))||0,support_started_at:c(u.startedAt),support_ended_at:c(u.endedAt)}),$=u=>{const f=Number(u.supportSpend.replace(/[^0-9]/g,""))||0,n=c(u.startedAt),s=c(u.endedAt);return`
INSERT INTO support_result (
  support_title,
  support_content,
  support_spend,
  support_started_at,
  support_ended_at
) VALUES (
  '${u.supportTitle}',
  ${u.supportContent?`'${u.supportContent}'`:"NULL"},
  ${f},
  '${n}',
  '${s}'
);`},V=u=>{console.log("==== ìž„ì‹œì €ìž¥ SQL ===="),console.log($(u))},S=async u=>{if(console.log("==== ìŠ¹ì¸ìš”ì²­ SQL ===="),console.log($(u)),!u.supportTitle){alert("ì§€ì› ì œëª©ì€ í•„ìˆ˜ìž…ë‹ˆë‹¤.");return}try{const f=b(u);await k.post("/api/staff/support-result",f),alert("ì§€ì› ê²°ê³¼ê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤!")}catch(f){console.error(f),alert("ì €ìž¥ ì‹¤íŒ¨! ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.")}},y=u=>{t.value=t.value.filter(f=>f.id!==u)},o=()=>t.value.push(a());return(u,f)=>(d(),v("div",yt,[f[5]||(f[5]=e("h1",{class:"text-3xl font-extrabold mb-8 text-gray-800 border-b-4 border-indigo-300 pb-2"}," ðŸ“ ì§€ì› ê²°ê³¼ ìž‘ì„± ",-1)),e("div",_t,[(d(!0),v(A,null,F(t.value,n=>(d(),v("div",{key:n.id,class:"card flex flex-col gap-4 w-full border p-4 rounded-md shadow-sm mt-8"},[e("div",xt,[f[0]||(f[0]=e("label",{class:"font-medium text-gray-700"},"ì§€ì› ì œëª©",-1)),l(i(I),{modelValue:n.supportTitle,"onUpdate:modelValue":s=>n.supportTitle=s,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",gt,[f[1]||(f[1]=e("label",{class:"font-medium text-gray-700"},"ì§€ì› ê¸ˆì•¡",-1)),l(i(I),{modelValue:n.supportSpend,"onUpdate:modelValue":s=>n.supportSpend=s,onInput:s=>r(n),class:"w-full text-right"},null,8,["modelValue","onUpdate:modelValue","onInput"])]),e("div",wt,[e("div",bt,[f[2]||(f[2]=e("label",{class:"font-medium text-gray-700"},"ì‹œìž‘ ì¼ìž",-1)),l(i(E),{modelValue:n.startedAt,"onUpdate:modelValue":s=>n.startedAt=s,dateFormat:"yy/mm/dd",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",$t,[f[3]||(f[3]=e("label",{class:"font-medium text-gray-700"},"ì¢…ë£Œ ì¼ìž",-1)),l(i(E),{modelValue:n.endedAt,"onUpdate:modelValue":s=>n.endedAt=s,dateFormat:"yy/mm/dd",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])]),e("div",ht,[f[4]||(f[4]=e("label",{class:"font-medium text-gray-700"},"ìƒì„¸ ë‚´ì—­",-1)),l(i(N),{modelValue:n.supportContent,"onUpdate:modelValue":s=>n.supportContent=s,rows:"4",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Vt,[l(i(C),{label:"ìž„ì‹œì €ìž¥",severity:"secondary",onClick:()=>V(n)},null,8,["onClick"]),l(i(C),{label:"ì‚­ì œ",severity:"danger",disabled:t.value.length===1,onClick:()=>y(n.id)},null,8,["disabled","onClick"]),l(i(C),{label:"ìŠ¹ì¸ìš”ì²­",severity:"success",onClick:()=>S(n)},null,8,["onClick"])])]))),128)),e("div",St,[l(i(C),{label:"ì¶”ê°€",icon:"pi pi-plus",severity:"info",onClick:o})])])]))}},Ct=X(kt,[["__scopeId","data-v-46a2ee3f"]]),It={class:"card p-5 shadow-md rounded-xl bg-white"},qt={class:"card flex flex-col gap-4 w-full"},Ut={key:0},Tt={key:1},Dt={__name:"AppReportRegistration",props:["ward-id"],setup(_){const x=w("0"),a=t=>{x.value=t};return(t,r)=>{const c=J,b=G,$=K;return d(),v("div",It,[e("div",qt,[r[2]||(r[2]=e("div",{class:"font-semibold text-xl mb-4"},"ë³´ê³ ì„œ ìž‘ì„±ëª©ë¡",-1)),l($,{value:x.value,"onUpdate:value":a},{default:g(()=>[l(b,null,{default:g(()=>[l(c,{value:"0"},{default:g(()=>[...r[0]||(r[0]=[D("ì§€ì›ê³„íšì„œ",-1)])]),_:1}),l(c,{value:"1"},{default:g(()=>[...r[1]||(r[1]=[D("ì§€ì›ê²°ê³¼ì„œ",-1)])]),_:1})]),_:1})]),_:1},8,["value"]),x.value==="0"?(d(),v("div",Ut,[l(ft,{"ward-id":t.wardId},null,8,["ward-id"])])):q("",!0),x.value==="1"?(d(),v("div",Tt,[l(Ct)])):q("",!0)])])}}},At={class:"flex flex-col md:flex-row w-full min-h-screen gap-4 p-4"},Ft={class:"w-full md:w-1/2 flex flex-col gap-4",style:{"max-height":"calc(100vh - 2rem)","overflow-y":"auto"}},Lt={class:"w-full md:w-1/2 flex flex-col",style:{"max-height":"calc(100vh - 2rem)","overflow-y":"auto"}},il={__name:"Survey",props:{surveyNo:{type:Number,required:!0}},setup(_){const x=_,a=w(null),t=w(null);return z(async()=>{try{const r=await k.get(`/api/staff/${x.surveyNo}`);console.log("DB ì‘ë‹µ ì „ì²´:",r.data);const c=r.data.result&&r.data.result.length>0?r.data.result[0]:null;c?(a.value=c,t.value=c.í”¼ë³´í˜¸ìžë²ˆí˜¸):console.error("ì¡°íšŒëœ í”¼ë³´í˜¸ìž ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")}catch(r){console.error("Survey ìƒì„¸ ì¡°íšŒ ì˜¤ë¥˜:",r)}}),(r,c)=>(d(),v("div",At,[e("div",Ft,[l(we,{"ward-id":t.value,"applicant-data":a.value},null,8,["ward-id","applicant-data"]),l(tt,{"ward-id":t.value},null,8,["ward-id"])]),e("div",Lt,[l(Dt,{"ward-id":t.value,class:"flex-1"},null,8,["ward-id"])])]))}};export{il as default};
