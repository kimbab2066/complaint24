import{s as I,a as c}from"./index-DFkLlqX2.js";import{ax as L,X as h,ay as C,a1 as E,aF as U,az as r,aO as s,e as D,p as i,g as l,w as t,aJ as n,aG as $,o as N,a3 as _,t as m,D as b,f as B}from"./index-CIvZqnG9.js";import{s as w}from"./index-Q5f-HasL.js";import{s as O,a as H}from"./index-2HQD3IZ5.js";import{s as T}from"./index-C-9Jg-N0.js";import{s as Q}from"./index-D5j367Ho.js";import"./index-B8K14yKN.js";import"./index-rSX_qRTu.js";import"./index-D3alGoI6.js";import"./index-CI70ECEq.js";import"./index-DrWbS65R.js";import"./index-DtbhESyl.js";import"./index-ntJNSm1c.js";import"./index-CDHacQLo.js";import"./index-vf1YAX2A.js";import"./index-DRZUHWhE.js";import"./index-DaQCVIMN.js";import"./index-m-AAtQFb.js";import"./index-a5Coulkh.js";import"./index-D2qeKuO0.js";import"./index-C8f_UxCN.js";const W={class:"card"},j={class:"flex justify-between"},z={class:"flex items-center gap-2"},G={key:0},K=["onClick"],P={class:"flex items-center gap-2"},J={class:"flex items-center gap-2"},X={class:"flex items-center gap-2"},q={class:"flex items-center gap-2"},Y={__name:"SystemDataBoard",setup(Z){const M=$(),f=h([]);h([]);const p=h({global:{value:null,matchMode:r.CONTAINS},name:{operator:s.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},"country.name":{operator:s.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},representative:{value:null,matchMode:r.IN},date:{operator:s.AND,constraints:[{value:null,matchMode:r.DATE_IS}]},balance:{operator:s.AND,constraints:[{value:null,matchMode:r.EQUALS}]},status:{operator:s.OR,constraints:[{value:null,matchMode:r.EQUALS}]},activity:{value:[0,100],matchMode:r.BETWEEN},verified:{value:null,matchMode:r.EQUALS}}),g=h(!0),S=C([{name:"장애인지원센터1"},{name:"장애인지원센터2"},{name:"장애인지원센터3"},{name:"장애인지원센터4"},{name:"장애인지원센터5"},{name:"장애인지원센터6"},{name:"장애인지원센터7"},{name:"장애인지원센터8"},{name:"장애인지원센터9"}]);E(async()=>{try{const o=(await U.get("/api/system/data-board/")).data;f.value=o.map((e,a)=>{const y=u=>{if(!u)return null;const v=new Date(u);return isNaN(v.getTime())?null:v};return console.log(e.board_no),{board_no:e.board_no??a,name:e.no,institution_name:{name:e.institution_name},writer:{name:e.writer},file_no:{name:e.file_no},title:{name:e.title},date:y(e.created_at),balance:0}}),console.log("DB 데이터 로드 성공:",f.value)}catch(d){console.error("백엔드 API 호출 실패:",d),f.value=[]}finally{g.value=!1}F()});function x(){M.push({name:"RegistFile"})}function F(){p.value={global:{value:null,matchMode:r.CONTAINS},name:{operator:s.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},"country.name":{operator:s.AND,constraints:[{value:null,matchMode:r.STARTS_WITH}]},representative:{value:null,matchMode:r.IN},date:{operator:s.AND,constraints:[{value:null,matchMode:r.DATE_IS}]},balance:{operator:s.AND,constraints:[{value:null,matchMode:r.EQUALS}]},status:{operator:s.OR,constraints:[{value:null,matchMode:r.EQUALS}]}}}function k(d){return d?d.toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}):""}const R=async function(o){try{const e=await U.get(`/api/system/data-board/download/${o}`,{responseType:"blob"}),a=new Blob([e.data]),y=window.URL.createObjectURL(a),u=document.createElement("a");u.href=y;const v=e.headers["content-disposition"];let V=o;if(v){const A=v.match(/filename="?(.+)"?/);A&&(V=decodeURIComponent(A[1]))}u.download=V,u.click(),window.URL.revokeObjectURL(y)}catch(e){console.error("파일 다운로드 실패:",e)}};return(d,o)=>(N(),D("div",W,[o[6]||(o[6]=i("div",{class:"font-semibold text-xl mb-4"},"자료실",-1)),l(n(I),{filters:p.value,"onUpdate:filters":o[2]||(o[2]=e=>p.value=e),value:f.value,paginator:!0,rows:10,dataKey:"id",rowHover:!0,filterDisplay:"menu",loading:g.value,globalFilterFields:["name","country.name","representative.name","balance","status"],showGridlines:""},{header:t(()=>[i("div",j,[l(n(b),{type:"button",icon:"pi pi-fw pi-pencil",label:"파일 등록",outlined:"",onClick:o[0]||(o[0]=e=>x())}),l(n(O),null,{default:t(()=>[l(n(H),null,{default:t(()=>[...o[3]||(o[3]=[i("i",{class:"pi pi-search"},null,-1)])]),_:1}),l(n(w),{modelValue:p.value.global.value,"onUpdate:modelValue":o[1]||(o[1]=e=>p.value.global.value=e),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})])]),empty:t(()=>[...o[4]||(o[4]=[_(" No file found. ",-1)])]),loading:t(()=>[...o[5]||(o[5]=[_(" Loading file data. Please wait. ",-1)])]),default:t(()=>[l(n(c),{field:"name",header:"자료 번호",style:{"min-width":"12rem"}},{body:t(({data:e})=>[_(m(e.board_no),1)]),filter:t(({filterModel:e})=>[l(n(w),{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,type:"text",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(n(c),{header:"자료명",filterField:"country.name",style:{"min-width":"12rem"}},{body:t(({data:e})=>[i("div",z,[i("span",null,m(e.title.name),1)])]),filter:t(({filterModel:e})=>[l(n(w),{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,type:"text",placeholder:"Search by country"},null,8,["modelValue","onUpdate:modelValue"])]),filterclear:t(({filterCallback:e})=>[l(n(b),{type:"button",icon:"pi pi-times",onClick:a=>e(),severity:"secondary"},null,8,["onClick"])]),filterapply:t(({filterCallback:e})=>[l(n(b),{type:"button",icon:"pi pi-check",onClick:a=>e(),severity:"success"},null,8,["onClick"])]),_:1}),l(n(c),{header:"첨부 파일",style:{"min-width":"8rem"}},{body:t(({data:e})=>[e.file_no.name?(N(),D("div",G,[i("i",{class:"pi pi-save",style:{cursor:"pointer","font-size":"1.2rem"},onClick:a=>R(e.file_no.name),title:"파일 다운로드"},null,8,K)])):B("",!0)]),_:1}),l(n(c),{header:"작성 기관",filterField:"representative",showFilterMatchModes:!1,filterMenuStyle:{width:"14rem"},style:{"min-width":"14rem"}},{body:t(({data:e})=>[i("div",P,[i("span",null,m(e.institution_name.name),1)])]),filter:t(({filterModel:e})=>[l(n(T),{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,options:S,optionLabel:"name",placeholder:"Any"},{option:t(a=>[i("div",J,[i("span",null,m(a.option.name),1)])]),_:1},8,["modelValue","onUpdate:modelValue","options"])]),_:1}),l(n(c),{header:"작성자",filterField:"representative",showFilterMatchModes:!1,filterMenuStyle:{width:"14rem"},style:{"min-width":"14rem"}},{body:t(({data:e})=>[i("div",X,[i("span",null,m(e.writer.name),1)])]),filter:t(({filterModel:e})=>[l(n(T),{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,options:S,optionLabel:"name",placeholder:"Any"},{option:t(a=>[i("div",q,[i("span",null,m(a.option.name),1)])]),_:1},8,["modelValue","onUpdate:modelValue","options"])]),_:1}),l(n(c),{header:"등록일",filterField:"date",dataType:"date",style:{"min-width":"10rem"}},{body:t(({data:e})=>[_(m(k(e.date)),1)]),filter:t(({filterModel:e})=>[l(n(Q),{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,dateFormat:"mm/dd/yy",placeholder:"mm/dd/yyyy"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["filters","value","loading"])]))}},ge=L(Y,[["__scopeId","data-v-0257b809"]]);export{ge as default};
