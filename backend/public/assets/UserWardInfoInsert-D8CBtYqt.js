import{aD as D,bk as M,X as i,a1 as S,e as B,p as a,t as N,j as r,aH as s,q as g,a3 as w,bs as k,aK as R,aF as y,aG as $,o as j}from"./index-CIvZqnG9.js";const C={class:"container mx-auto p-4"},K={class:"text-2xl font-bold mb-4"},P=["disabled"],z={class:"mt-1 flex items-center space-x-2"},F=["disabled"],L=["disabled"],T={class:"mt-1 flex space-x-4"},W=["disabled"],q=["disabled"],G=["disabled"],H=["disabled"],X={class:"mt-1"},Y={class:"flex items-center space-x-2 mb-2"},O={__name:"UserWardInfoInsert",props:{ward_no:{type:String,default:null}},setup(h){const v=h,x=$(),V=D(),o=M(()=>!!v.ward_no),t=i({name:"",ward_rrn:"",sex:"",age:"",address:"",guardian_id:V.user.id,guardian_relation:"",disabled_level:""}),n=i(""),u=i(""),f=i(null),p=i(""),m=i(""),b=i(""),U=async()=>{if(o.value)try{const e=(await y.get("/api/user/wardlist",{params:{guardianId:t.value.guardian_id}})).data.result.find(l=>l.ward_no===parseInt(v.ward_no));if(e&&(t.value={...e},t.value.ward_rrn&&t.value.ward_rrn.length===13?(n.value=t.value.ward_rrn.substring(0,6),u.value=t.value.ward_rrn.substring(6)):(n.value=t.value.ward_rrn,u.value=""),t.value.address)){const l=t.value.address.split("!");p.value=l[0]||"",m.value=l[1]||"",b.value=l[2]||""}}catch(d){console.error("Error fetching ward data:",d),alert("피보호자 정보를 불러오는 데 실패했습니다.")}},c=(d,e)=>{let l=d.target.value.replace(/[^0-9]/g,"");e==="rrn1"?(n.value=l.slice(0,6),n.value.length===6&&f.value&&f.value.focus()):e==="rrn2"&&(u.value=l.slice(0,7))},I=(d,e)=>{if(d.key==="Backspace"&&u.value.length===0){d.preventDefault();const l=document.getElementById("ward_rrn1");l&&l.focus()}},_=()=>{new window.daum.Postcode({oncomplete:d=>{let e=d.roadAddress,l="";d.bname!==""&&/[동|로|가]$/g.test(d.bname)&&(l+=d.bname),d.buildingName!==""&&d.apartment==="Y"&&(l+=l!==""?", "+d.buildingName:d.buildingName),l!==""&&(l=" ("+l+")"),p.value=d.zonecode,m.value=e,l!==""&&(m.value+=l),b.value=""}}).open()},A=async()=>{try{t.value.ward_rrn=n.value+u.value,t.value.address=`${p.value}!${m.value}!${b.value}`,o.value?(await y.put(`/api/user/wards/${v.ward_no}`,t.value),alert("정보가 성공적으로 수정되었습니다.")):(await y.post("/api/user/wards",t.value),alert("피보호자가 성공적으로 등록되었습니다.")),x.push({name:"umy"})}catch(d){console.error("Error submitting form:",d),alert("작업을 완료하는 데 실패했습니다.")}},E=()=>{x.go(-1)};return S(()=>{if(U(),typeof window.daum>"u"||!window.daum.Postcode){const d=document.createElement("script");d.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",d.async=!0,document.head.appendChild(d)}}),(d,e)=>(j(),B("div",C,[a("h1",K,N(o.value?"피보호자 정보 수정":"신규 피보호자 등록"),1),a("form",{onSubmit:R(A,["prevent"]),class:"space-y-4"},[a("div",null,[e[15]||(e[15]=a("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"이름",-1)),r(a("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=l=>t.value.name=l),disabled:o.value,class:g(["mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",{"bg-gray-100":o.value,"bg-white":!o.value}])},null,10,P),[[s,t.value.name]])]),a("div",null,[e[17]||(e[17]=a("label",{for:"ward_rrn1",class:"block text-sm font-medium text-gray-700"},"주민등록번호",-1)),a("div",z,[r(a("input",{type:"text",id:"ward_rrn1","onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),onInput:e[2]||(e[2]=l=>c(l,"rrn1")),disabled:o.value,maxlength:"6",class:g(["block w-32 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-center",{"bg-gray-100":o.value,"bg-white":!o.value}])},null,42,F),[[s,n.value]]),e[16]||(e[16]=a("span",null,"-",-1)),r(a("input",{type:"text",id:"ward_rrn2",ref_key:"rrn2Input",ref:f,"onUpdate:modelValue":e[3]||(e[3]=l=>u.value=l),onInput:e[4]||(e[4]=l=>c(l,"rrn2")),onKeydown:e[5]||(e[5]=l=>I(l)),disabled:o.value,maxlength:"7",class:g(["block w-40 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-center",{"bg-gray-100":o.value,"bg-white":!o.value}])},null,42,L),[[s,u.value]])])]),a("div",null,[e[20]||(e[20]=a("label",{class:"block text-sm font-medium text-gray-700"},"성별",-1)),a("div",T,[a("label",null,[r(a("input",{type:"radio",value:"MALE","onUpdate:modelValue":e[6]||(e[6]=l=>t.value.sex=l),disabled:o.value,class:"mr-1"},null,8,W),[[k,t.value.sex]]),e[18]||(e[18]=w(" 남성",-1))]),a("label",null,[r(a("input",{type:"radio",value:"FEMALE","onUpdate:modelValue":e[7]||(e[7]=l=>t.value.sex=l),disabled:o.value,class:"mr-1"},null,8,q),[[k,t.value.sex]]),e[19]||(e[19]=w(" 여성",-1))])])]),a("div",null,[e[21]||(e[21]=a("label",{for:"age",class:"block text-sm font-medium text-gray-700"},"나이",-1)),r(a("input",{type:"number",id:"age","onUpdate:modelValue":e[8]||(e[8]=l=>t.value.age=l),disabled:o.value,class:g(["mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",{"bg-gray-100":o.value,"bg-white":!o.value}])},null,10,G),[[s,t.value.age]])]),a("div",null,[e[22]||(e[22]=a("label",{for:"guardian_name",class:"block text-sm font-medium text-gray-700"}," 보호자 ID ",-1)),r(a("input",{type:"text",id:"guardian_name","onUpdate:modelValue":e[9]||(e[9]=l=>t.value.guardian_id=l),disabled:"",class:"mt-1 block w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md shadow-sm"},null,512),[[s,t.value.guardian_id]])]),a("div",null,[e[23]||(e[23]=a("label",{for:"guardian_relation",class:"block text-sm font-medium text-gray-700"},"보호자 관계",-1)),r(a("input",{type:"text",id:"guardian_relation","onUpdate:modelValue":e[10]||(e[10]=l=>t.value.guardian_relation=l),disabled:o.value,class:g(["mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",{"bg-gray-100":o.value,"bg-white":!o.value}])},null,10,H),[[s,t.value.guardian_relation]])]),a("div",null,[e[24]||(e[24]=a("label",{for:"address",class:"block text-sm font-medium text-gray-700"},"주소",-1)),a("div",X,[a("div",Y,[r(a("input",{type:"text",id:"postcode","onUpdate:modelValue":e[11]||(e[11]=l=>p.value=l),placeholder:"우편번호",class:"block w-24 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm sm:text-sm"},null,512),[[s,p.value]]),a("button",{type:"button",onClick:_,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300"}," 주소 검색 ")]),r(a("input",{type:"text",id:"fullAddress","onUpdate:modelValue":e[12]||(e[12]=l=>m.value=l),placeholder:"주소",class:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm sm:text-sm"},null,512),[[s,m.value]]),r(a("input",{type:"text",id:"detailAddress","onUpdate:modelValue":e[13]||(e[13]=l=>b.value=l),placeholder:"상세주소",class:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[s,b.value]])])]),a("div",null,[e[25]||(e[25]=a("label",{for:"disabled_level",class:"block text-sm font-medium text-gray-700"},"장애 수준",-1)),r(a("input",{type:"text",id:"disabled_level","onUpdate:modelValue":e[14]||(e[14]=l=>t.value.disabled_level=l),class:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[s,t.value.disabled_level]])]),a("div",{class:"flex justify-end space-x-2"},[a("button",{type:"button",onClick:E,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300"}," 취소 "),e[26]||(e[26]=a("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," 저장 ",-1))])],32)]))}};export{O as default};
