import{Z as w,X as f,aF as y,aG as F,e as b,p as t,g as d,aJ as a,w as V,D as R,o as U}from"./index-CIvZqnG9.js";import{s as B}from"./index-B9nMDJgt.js";import{s as N}from"./index-D3alGoI6.js";import{s as C}from"./index-Q5f-HasL.js";import"./index-m-AAtQFb.js";import"./index-Du4PgxzQ.js";import"./index-Bu41pstU.js";import"./index-B8K14yKN.js";import"./index-CI70ECEq.js";import"./index-2HQD3IZ5.js";import"./index-DrWbS65R.js";function S(){const _=F(),s=w(),i=f([{name:"기관 1",code:"institution 1"},{name:"기관 2",code:"institution 2"},{name:"기관 3",code:"institution 3"},{name:"기관 4",code:"institution 4"},{name:"기관 5",code:"institution 5"},{name:"기관 6",code:"institution 6"},{name:"기관 7",code:"institution 7"},{name:"기관 8",code:"institution 8"}]),o=f({writer:null,title:null,file_no:null,institution_name:null});return f([]),{institutionList:i,basicInfo:o,requestApproval:async u=>{var m,l;if(!o.value.institution_name||!o.value.writer||!o.value.title)return s.add({severity:"warn",summary:"입력 필요",detail:"자료명, 작성기관, 작성자를 모두 입력하세요.",life:3e3});if(!u)return s.add({severity:"warn",summary:"입력 필요",detail:"파일을 첨부하세요.",life:3e3});const n=new FormData;n.append("uploadFile",u),n.append("institution_name",o.value.institution_name.name),n.append("writer",o.value.writer),n.append("title",o.value.title),n.append("parent_id",1),n.append("parent_tablename","board");try{const c=(await y.post("/api/system/data-board",n,{headers:{"Content-Type":"multipart/form-data"}})).data.fileNo;s.add({severity:"success",summary:"등록 성공",detail:`파일 및 게시글 등록 완료! (File No: ${c})`,life:3e3}),_.push("/system/data-board")}catch(e){console.error("등록 실패:",e),s.add({severity:"error",summary:"등록 실패",detail:"등록에 실패했습니다: "+(((l=(m=e.response)==null?void 0:m.data)==null?void 0:l.message)||e.message),life:5e3})}}}}const $={class:"flex flex-col md:flex-row gap-8"},k={class:"md:w-1/2 flex flex-col gap-8"},q={class:"card flex flex-col gap-6"},A={class:"flex flex-col gap-3"},D={class:"flex flex-col gap-3"},I={class:"flex flex-col gap-3"},L={class:"flex flex-col gap-3"},K={__name:"RegistFile",setup(_){const{institutionList:s,basicInfo:i,requestApproval:o}=S(),r=f(null),u=l=>{l.files&&l.files.length>0&&(r.value=l.files[0],console.log("선택된 파일:",r.value.name))},n=()=>{r.value=null,console.log("파일이 제거되었습니다.")},m=()=>{o(r.value)};return(l,e)=>{const c=C,v=N,x=B,g=R;return U(),b("div",$,[t("div",k,[t("div",q,[t("div",A,[e[3]||(e[3]=t("label",{for:"name1"},"자료명",-1)),d(c,{id:"name1",type:"text",modelValue:a(i).title,"onUpdate:modelValue":e[0]||(e[0]=p=>a(i).title=p)},null,8,["modelValue"])]),t("div",D,[e[4]||(e[4]=t("label",{for:"institution_name"},"작성기관",-1)),d(v,{code:"institution_name",modelValue:a(i).institution_name,"onUpdate:modelValue":e[1]||(e[1]=p=>a(i).institution_name=p),options:a(s),optionLabel:"name",placeholder:"미선택",class:"w-full"},null,8,["modelValue","options"])]),t("div",I,[e[5]||(e[5]=t("label",{for:"fileWriter"},"작성자",-1)),d(c,{id:"name1",type:"text",modelValue:a(i).writer,"onUpdate:modelValue":e[2]||(e[2]=p=>a(i).writer=p)},null,8,["modelValue"])]),t("div",L,[e[7]||(e[7]=t("label",{for:"title"},"파일첨부",-1)),d(x,{name:"filedata",multiple:!1,customUpload:!0,onSelect:u,onRemove:n,auto:!1,showUploadButton:!1,showCancelButton:!0,accept:".pdf,.doc,.docx,.hwp,.zip, jpg, jpeg, png, gif",maxFileSize:1e7},{empty:V(()=>[...e[6]||(e[6]=[t("p",null,"파일을 드래그 앤 드롭하거나 선택해주세요.",-1)])]),_:1})]),d(g,{label:"등록 요청",icon:"pi pi-send",severity:"info",onClick:m})])])])}}};export{K as default};
