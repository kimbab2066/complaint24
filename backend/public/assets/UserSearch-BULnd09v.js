import{s as A}from"./index-BPbqiqrq.js";import{ax as D,X as l,a1 as K,bk as T,e as r,p as e,g as _,aI as E,aJ as p,t as h,q as w,j as N,am as Q,F as $,a4 as S,aK as V,aF as W,o as n,d as j,w as z,D as J}from"./index-CIvZqnG9.js";import{s as P}from"./index-Q5f-HasL.js";import{s as X}from"./index-vf1YAX2A.js";import{s as G}from"./index-CVVAIkGy.js";import"./index-DRZUHWhE.js";const O={class:"ts-search-root"},Y={class:"search-row"},Z={class:"search-input"},ee={class:"search-meta"},te={class:"applied"},se={class:"layout"},ae={class:"filter-body"},oe={class:"filter-group"},le={class:"label"},ne={class:"main-results"},re={class:"sort-row"},ie={class:"sort-options"},ce={key:0,class:"status-message"},ue={key:1,class:"status-message error"},de={key:2,class:"results-grid"},ve={key:0,class:"no-results"},_e={key:1,class:"grid"},pe={class:"card-content"},he={class:"card-header"},me=["innerHTML"],ge=["innerHTML"],fe={class:"card-footer"},ye={__name:"UserSearch",setup(be){const i=l(""),m=l([]),x=l([{board_no:-1,institution_name:"웹사이트",category:"menu",writer:"운영자",title:"사업 공고",content:"진행중인 사업 목록을 확인하고 지원하세요.",hashtag:"#menu",created_at:"2025-11-13",updated_at:"2025-11-13"},{board_no:-2,institution_name:"웹사이트",category:"menu",writer:"운영자",title:"사업 신청",content:"관심있는 사업에 직접 신청할 수 있습니다.",hashtag:"#menu",created_at:"2025-11-19",updated_at:"2025-11-19"},{board_no:-3,institution_name:"웹사이트",category:"menu",writer:"운영자",title:"피보호자 등록",content:"서비스를 받을 피보호자를 등록하고 관리합니다.",hashtag:"#menu",created_at:"2025-11-16",updated_at:"2025-11-16"},{board_no:-4,institution_name:"웹사이트",category:"menu",writer:"운영자",title:"상담 예약",content:"전문가와 상담을 예약할 수 있습니다.",hashtag:"#menu",created_at:"2025-11-20",updated_at:"2025-11-20"},{board_no:-5,institution_name:"웹사이트",category:"menu",writer:"운영자",title:"Q&A",content:"자주 묻는 질문과 답변을 확인하세요.",hashtag:"#menu",created_at:"2025-01-01",updated_at:"2025-01-01"},{board_no:-6,institution_name:"웹사이트",category:"menu",writer:"운영자",title:"자료실",content:"관련 서식이나 자료를 다운로드할 수 있습니다.",hashtag:"#menu",created_at:"2025-11-16",updated_at:"2025-11-16"}]),g=l(!1),u=l(null),d=l(["notice","archive","menu"]),c=l("recent"),M=l(1),f=async()=>{g.value=!0,u.value=null;const s=i.value.trim();let t={};s&&(s.startsWith("#")?(t.type="hashtag",t.term=s.substring(1)):(t.type="general",t.term=s));try{const o=await W.get("/api/user/user-board",{params:t});m.value=[...o.data.result,...x.value]}catch(o){console.error("API search failed:",o),u.value="검색 결과를 불러오는 데 실패했습니다.",m.value=[]}finally{g.value=!1}};K(()=>{const s=history.state.searchQuery;s&&(i.value=s),f()});function B(){d.value=["notice","archive","menu"]}const y=T(()=>{let s=[...m.value];const t=d.value;return s=s.filter(o=>t.includes(o.category)),c.value==="recent"?s.sort((o,a)=>(a.created_at||"").localeCompare(o.created_at||"")):c.value==="oldest"&&s.sort((o,a)=>(o.created_at||"").localeCompare(a.created_at||"")),s}),F=T(()=>y.value.length);function C(s,t){if(!t)return b(s);const o=t.startsWith("#")?t.substring(1):t;if(!o)return b(s);const a=String(o).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),k=new RegExp(`(${a})`,"gi");return b(s).replace(k,'<strong class="hl">$1</strong>')}function b(s=""){return String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function H(){M.value=1,f()}function L(){f()}function I(){window.scrollTo({top:0,behavior:"smooth"})}function R(){window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})}const U=[{key:"notice",label:"지원 계획"},{key:"archive",label:"자료실"},{key:"menu",label:"사이트 메뉴명"}],v=l(!1);function q(){v.value=!v.value}return(s,t)=>{const o=A;return n(),r("section",O,[t[5]||(t[5]=e("nav",{class:"breadcrumb"},[e("a",{href:"/",class:"crumb"},"홈"),e("span",{class:"sep"},"›"),e("span",{class:"crumb current"},"통합검색")],-1)),e("div",Y,[e("div",Z,[_(p(P),{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=a=>i.value=a),placeholder:"무엇이 궁금하신가요? (#태그 검색 가능)",onKeyup:E(H,["enter"])},null,8,["modelValue"])]),e("div",ee,[e("div",te," 적용된 검색어: '"+h(i.value||"전체")+"' · 검색 결과: "+h(F.value),1)])]),e("div",se,[e("aside",{class:w(["side-filter",{collapsed:v.value}])},[e("div",{class:"filter-header"},[t[4]||(t[4]=e("h4",null,"검색 필터",-1)),e("div",null,[e("button",{class:"reset",onClick:B,title:"필터 초기화"},"⟲"),e("button",{class:"collapse",onClick:q,title:"접기/펼치기"},"▾")])]),N(e("div",ae,[e("div",oe,[(n(),r($,null,S(U,a=>e("label",{key:a.key,class:"filter-item"},[_(p(X),{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=k=>d.value=k),inputId:a.key,value:a.key},null,8,["modelValue","inputId","value"]),e("span",le,h(a.label),1)])),64))])],512),[[Q,!v.value]])],2),e("main",ne,[e("div",re,[e("div",ie,[e("a",{href:"#",class:w({active:c.value==="recent"}),onClick:t[2]||(t[2]=V(a=>c.value="recent",["prevent"]))},"최신순",2),e("a",{href:"#",class:w({active:c.value==="oldest"}),onClick:t[3]||(t[3]=V(a=>c.value="oldest",["prevent"]))},"오래된 순",2)])]),g.value?(n(),r("div",ce,"검색 중...")):u.value?(n(),r("div",ue,h(u.value),1)):(n(),r("div",de,[y.value.length===0?(n(),r("div",ve,"검색 결과가 없습니다.")):(n(),r("div",_e,[(n(!0),r($,null,S(y.value,a=>(n(),j(p(G),{key:a.board_no,class:"result-card"},{content:z(()=>[e("div",pe,[e("div",he,[_(o,{value:a.category},null,8,["value"])]),e("div",{class:"card-title",innerHTML:C(a.title,i.value)},null,8,me),e("div",{class:"excerpt",innerHTML:C(a.content,i.value)},null,8,ge),e("div",fe,[_(p(J),{label:"사이트 가기",class:"p-button-outlined"})])])]),_:2},1024))),128))]))]))])]),e("div",{class:"fab-group"},[e("button",{class:"fab",title:"새로고침",onClick:L},"⟲"),e("button",{class:"fab",title:"위로",onClick:I},"▲"),e("button",{class:"fab",title:"아래로",onClick:R},"▼")])])}}},Ve=D(ye,[["__scopeId","data-v-2b492e6f"]]);export{Ve as default};
