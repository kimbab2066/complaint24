import{Z as M,aD as T,X as w,bk as g,a1 as B,bl as F,e as L,p as s,t as d,g as n,w as a,a3 as u,aJ as r,aG as V,o as A}from"./index-CIvZqnG9.js";import{s as y}from"./index-CVVAIkGy.js";import{a as c,s as E}from"./index-DFkLlqX2.js";import{s as J}from"./index-BPbqiqrq.js";import"./index-B8K14yKN.js";import"./index-rSX_qRTu.js";import"./index-D3alGoI6.js";import"./index-CI70ECEq.js";import"./index-2HQD3IZ5.js";import"./index-Q5f-HasL.js";import"./index-DrWbS65R.js";import"./index-DtbhESyl.js";import"./index-ntJNSm1c.js";import"./index-CDHacQLo.js";import"./index-vf1YAX2A.js";import"./index-DRZUHWhE.js";import"./index-DaQCVIMN.js";import"./index-m-AAtQFb.js";const Y={class:"dashboard-layout"},G={class:"main-content"},K={class:"welcome-message"},O={class:"summary-message"},X={class:"stat-cards-container"},Z={class:"stat-value"},j={class:"count-blue"},q={class:"stat-value"},z={class:"count-green"},H={class:"stat-value"},I={class:"count-red"},Q={class:"table-container"},gt={__name:"StaffDashboard",setup(U){const v=V(),_=M(),D=T(),l=w([]),m=w(!0),S=g(()=>{var e;return((e=D.user)==null?void 0:e.name)||"담당자"});B(()=>{b()});async function b(){m.value=!0;try{const e=await F.getReservations();l.value=e.data,console.log("Fetched Reservations Data:",JSON.stringify(l.value,null,2))}catch(e){console.error("대시보드 데이터 로딩 실패:",e),_.add({severity:"error",summary:"오류",detail:"대시보드 데이터를 불러오는 중 오류가 발생했습니다.",life:3e3})}finally{m.value=!1}}const p=g(()=>{if(!l.value||l.value.length===0)return{today:0,new:0,pending:0};const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1),$=l.value.filter(o=>{if(!o.start_time||!o.status)return!1;const h=new Date(o.start_time);return o.status.trim()==="예약확정"&&h>=t&&h<i}).length,x=l.value.filter(o=>o.status&&o.status.trim()==="예약확정").length,N=l.value.filter(o=>o.status&&o.status.trim()==="상담완료").length;return{today:$,new:x,pending:N}}),k=g(()=>{if(m.value)return"데이터를 불러오는 중입니다...";const e=p.value.today;return e>0?`오늘 처리해야 할 ${e}건의 상담 일정이 있습니다.`:"오늘 예정된 상담 일정이 없습니다."}),C=e=>{switch(e?e.trim():""){case"상담완료":return"success";case"예약확정":return"info";case"취소":return"danger";default:return"secondary"}},R=e=>e?new Date(e).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1}):"",f=e=>{e==="today-schedule"&&v.push({name:"reservations"}),e==="new-reservations"&&v.push({name:"reservations"}),e==="pending-reports"&&v.push({name:"counselinglist"})};return(e,t)=>(A(),L("div",Y,[s("div",G,[t[11]||(t[11]=s("h1",{class:"page-title"},"대시보드",-1)),s("p",K,d(S.value)+" 담당자님, 환영합니다.",1),s("p",O,[s("strong",null,d(k.value),1)]),s("div",X,[n(r(y),{class:"stat-card",onClick:t[0]||(t[0]=i=>f("today-schedule"))},{title:a(()=>[...t[3]||(t[3]=[u("오늘의 상담 일정",-1)])]),content:a(()=>[s("div",Z,[s("span",j,d(p.value.today),1),t[4]||(t[4]=u("건 ",-1))])]),_:1}),n(r(y),{class:"stat-card",onClick:t[1]||(t[1]=i=>f("new-reservations"))},{title:a(()=>[...t[5]||(t[5]=[u("신규 예약 신청",-1)])]),content:a(()=>[s("div",q,[s("span",z,d(p.value.new),1),t[6]||(t[6]=u("건 ",-1))])]),_:1}),n(r(y),{class:"stat-card",onClick:t[2]||(t[2]=i=>f("pending-reports"))},{title:a(()=>[...t[7]||(t[7]=[u("미작성 상담일지",-1)])]),content:a(()=>[s("div",H,[s("span",I,d(p.value.pending),1),t[8]||(t[8]=u("건 ",-1))])]),_:1})]),s("div",Q,[n(r(E),{value:l.value,loading:m.value,responsiveLayout:"scroll"},{header:a(()=>[...t[9]||(t[9]=[s("div",{class:"text-xl font-bold"},"최근 예약 목록",-1)])]),empty:a(()=>[...t[10]||(t[10]=[u(" 예약 내역이 없습니다. ",-1)])]),default:a(()=>[n(r(c),{field:"start_time",header:"시간",style:{width:"15%"}},{body:a(i=>[u(d(R(i.data.start_time)),1)]),_:1}),n(r(c),{field:"applicantName",header:"신청인(보호자)",style:{width:"25%"}}),n(r(c),{field:"wardName",header:"피보호자",style:{width:"25%"}}),n(r(c),{field:"res_reason",header:"상담사유",style:{width:"20%"}}),n(r(c),{field:"status",header:"상태",style:{width:"15%"}},{body:a(i=>[n(r(J),{value:i.data.status,severity:C(i.data.status)},null,8,["value","severity"])]),_:1})]),_:1},8,["value","loading"])])])]))}};export{gt as default};
