import{a as P,s as I}from"./index-DFkLlqX2.js";import{s as N}from"./index-BPbqiqrq.js";import{ax as R,Z as U,X as i,a1 as j,e as q,p as t,g as l,d as w,t as g,aI as h,D as A,ae as E,w as n,a3 as x,bo as F,aG as G,o as y}from"./index-CIvZqnG9.js";import{s as M}from"./index-Q5f-HasL.js";import{s as O}from"./index-COnWdjRO.js";import"./index-B8K14yKN.js";import"./index-rSX_qRTu.js";import"./index-D3alGoI6.js";import"./index-CI70ECEq.js";import"./index-2HQD3IZ5.js";import"./index-DrWbS65R.js";import"./index-DtbhESyl.js";import"./index-ntJNSm1c.js";import"./index-CDHacQLo.js";import"./index-vf1YAX2A.js";import"./index-DRZUHWhE.js";import"./index-DaQCVIMN.js";import"./index-m-AAtQFb.js";const S={class:"dashboard-layout"},X={class:"main-content"},Z={class:"search-container mb-6 p-4 bg-surface-0 border-round shadow-1 border-1 border-200"},z={class:"flex flex-col md:flex-row gap-3 items-end"},H={class:"w-full md:w-auto flex flex-col gap-2"},J={class:"w-full md:flex-1 flex flex-col gap-2"},Q={class:"text-sm font-bold text-600"},W={class:"table-container"},Y={class:"flex justify-content-center gap-2"},ee={__name:"CounselingList",setup(te){const V=G(),d=U(),s=i("guardian"),u=i(""),c=i(""),m=i(!1),p=i([]);function k(o){if(!o)return"-";try{return new Date(o).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return o}}async function _(){m.value=!0;try{const o={searchType:s.value,keyword:s.value==="date"?void 0:u.value,searchDate:s.value==="date"?c.value:void 0},e=await F.getLogs(o);p.value=e.data.data||[]}catch(o){console.error("목록 조회 실패:",o),d.add({severity:"error",summary:"조회 실패",detail:"상담 기록을 불러오는데 실패했습니다.",life:3e3}),p.value=[]}finally{m.value=!1}}function f(){_()}function D(o){d.add({severity:"info",summary:"상세 보기",detail:`${o}번 기록 상세 페이지로 이동합니다.`,life:3e3}),V.push({path:"/counseling-logform",query:{consultNo:o}})}function T(o){d.add({severity:"success",summary:"다운로드",detail:`${o}번 기록 PDF 다운로드를 시작합니다.`,life:3e3})}return j(()=>{_()}),(o,e)=>{const $=O,b=M,v=A,C=E,r=P,L=N,B=I;return y(),q("div",S,[t("div",X,[e[6]||(e[6]=t("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4"},[t("div",null,[t("h1",{class:"page-title"},"상담 기록 관리"),t("p",{class:"welcome-message"},"완료된 상담 일지를 조회하고 관리합니다.")])],-1)),t("div",Z,[t("div",z,[t("div",H,[e[3]||(e[3]=t("label",{class:"text-sm font-bold text-600"},"검색 기준",-1)),l($,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),options:[{label:"신청인(보호자)",value:"guardian"},{label:"상담일시",value:"date"},{label:"피보호자",value:"ward"}],optionLabel:"label",optionValue:"value",class:"w-full md:w-12rem"},null,8,["modelValue"])]),t("div",J,[t("label",Q,g(s.value==="date"?"날짜 선택":"검색어 입력"),1),s.value!=="date"?(y(),w(b,{key:0,modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),placeholder:"검색어를 입력하세요",class:"w-full",onKeyup:h(f,["enter"])},null,8,["modelValue"])):(y(),w(b,{key:1,type:"date",modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),class:"w-full",onKeyup:h(f,["enter"])},null,8,["modelValue"]))]),l(v,{label:"검색",icon:"pi pi-search",class:"w-full md:w-auto p-button-outlined p-button-secondary",onClick:f})])]),t("div",W,[l(C),l(B,{value:p.value,loading:m.value,responsiveLayout:"scroll",paginator:"",rows:10,rowsPerPageOptions:[5,10,20],class:"p-datatable-sm"},{empty:n(()=>[...e[4]||(e[4]=[t("div",{class:"text-center p-4"},"등록된 상담 기록이 없습니다.",-1)])]),loading:n(()=>[...e[5]||(e[5]=[x(" 데이터 로딩 중... ",-1)])]),default:n(()=>[l(r,{field:"consult_datetime",header:"상담 일시",sortable:!0,style:{"min-width":"12rem"}},{body:n(({data:a})=>[x(g(k(a.consult_datetime)),1)]),_:1}),l(r,{field:"guardian_name",header:"신청인(보호자)",style:{"min-width":"10rem"}}),l(r,{field:"ward_name",header:"피보호자",style:{"min-width":"8rem"}},{body:n(({data:a})=>[l(L,{value:a.ward_name,severity:"info",rounded:""},null,8,["value"])]),_:1}),l(r,{field:"survey_type",header:"조사지 종류",style:{"min-width":"10rem"}}),l(r,{header:"관리",style:{"min-width":"12rem","text-align":"center"}},{body:n(({data:a})=>[t("div",Y,[l(v,{label:"보기",icon:"pi pi-eye",class:"p-button-text p-button-sm p-button-info",onClick:K=>D(a.consult_no)},null,8,["onClick"]),l(v,{label:"다운로드",icon:"pi pi-download",class:"p-button-text p-button-sm p-button-secondary",onClick:K=>T(a.consult_no)},null,8,["onClick"])])]),_:1})]),_:1},8,["value","loading"])])])])}}},ge=R(ee,[["__scopeId","data-v-8f11a81d"]]);export{ge as default};
