import{s as k,a as E}from"./index-DFkLlqX2.js";import{s as $}from"./index-D5j367Ho.js";import{s as C}from"./index-C-9Jg-N0.js";import{s as B,a as R}from"./index-2HQD3IZ5.js";import{s as L}from"./index-Q5f-HasL.js";import{aG as A,d as O,o as I,D as N,ax as q,X as f,ay as P,a1 as W,aF as H,az as n,aO as s,e as Q,p as i,g as a,w as t,a3 as h,t as v}from"./index-CIvZqnG9.js";import{P as G}from"./ProductService-BtITuo-x.js";import"./index-B8K14yKN.js";import"./index-rSX_qRTu.js";import"./index-D3alGoI6.js";import"./index-CI70ECEq.js";import"./index-DrWbS65R.js";import"./index-DtbhESyl.js";import"./index-ntJNSm1c.js";import"./index-CDHacQLo.js";import"./index-vf1YAX2A.js";import"./index-DRZUHWhE.js";import"./index-DaQCVIMN.js";import"./index-m-AAtQFb.js";import"./index-D2qeKuO0.js";import"./index-C8f_UxCN.js";import"./index-a5Coulkh.js";const K={__name:"SurveyDetailButton",props:{surveyId:{type:[String,Number],required:!0}},setup(D){const y=D,m=A(),d=()=>{if(!y.surveyId){console.error("Survey ID가 제공되지 않았습니다.");return}m.push({name:"SurveyDetail",params:{id:y.surveyId}})};return(S,T)=>{const b=N;return I(),O(b,{label:"상세보기",icon:"pi pi-search",onClick:d,class:"p-button-text p-button-secondary p-button-sm"})}}},j={class:"card"},z={class:"flex justify-between"},X={class:"flex items-center gap-2"},J={class:"flex items-center gap-2"},Y={class:"flex items-center gap-2"},Z={__name:"SurveyTable",setup(D){const y=A(),m=f([]),d=f({global:{value:null,matchMode:n.CONTAINS},name:{operator:s.AND,constraints:[{value:null,matchMode:n.STARTS_WITH}]},"country.name":{operator:s.AND,constraints:[{value:null,matchMode:n.STARTS_WITH}]},representative:{value:null,matchMode:n.IN},date:{operator:s.AND,constraints:[{value:null,matchMode:n.DATE_IS}]},balance:{operator:s.AND,constraints:[{value:null,matchMode:n.EQUALS}]},status:{operator:s.OR,constraints:[{value:null,matchMode:n.EQUALS}]},activity:{value:[0,100],matchMode:n.BETWEEN},verified:{value:null,matchMode:n.EQUALS}}),S=f(!0),T=f([]),b=P([{name:"장애인지원센터1"},{name:"장애인지원센터2"},{name:"장애인지원센터3"},{name:"장애인지원센터4"},{name:"장애인지원센터5"},{name:"장애인지원센터6"},{name:"장애인지원센터7"},{name:"장애인지원센터8"},{name:"장애인지원센터9"}]);W(async()=>{G.getProductsWithOrdersSmall().then(u=>T.value=u);try{const o=(await H.get("/api/system/survey")).data;m.value=o.map((r,g)=>{const p=_=>{if(!_)return null;const c=new Date(_);return isNaN(c.getTime())?null:c};return{id:r.inquiry_no??g,name:r.inquiry_no??"-",country:{name:r.inquiry_name||"이름없음"},representative:{name:r.inquiry_writer||"미지정"},date:p(r.created_at),balance:0,status:r.inquiry_status||"미정"}}),console.log("DB 데이터 로드 성공:",m.value)}catch(u){console.error("백엔드 API 호출 실패:",u),m.value=[]}finally{S.value=!1}w()});function V(){y.push({name:"RegistSurvey"})}function w(){d.value={global:{value:null,matchMode:n.CONTAINS},name:{operator:s.AND,constraints:[{value:null,matchMode:n.STARTS_WITH}]},"country.name":{operator:s.AND,constraints:[{value:null,matchMode:n.STARTS_WITH}]},representative:{value:null,matchMode:n.IN},date:{operator:s.AND,constraints:[{value:null,matchMode:n.DATE_IS}]},balance:{operator:s.AND,constraints:[{value:null,matchMode:n.EQUALS}]},status:{operator:s.OR,constraints:[{value:null,matchMode:n.EQUALS}]}}}function M(u){return u?u.toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}):""}return(u,o)=>{const r=N,g=R,p=L,_=B,c=E,x=C,U=$,F=k;return I(),Q("div",j,[o[6]||(o[6]=i("div",{class:"font-semibold text-xl mb-4"},"조사지 관리",-1)),a(F,{filters:d.value,"onUpdate:filters":o[2]||(o[2]=e=>d.value=e),value:m.value,paginator:!0,rows:10,dataKey:"id",rowHover:!0,filterDisplay:"menu",loading:S.value,globalFilterFields:["name","country.name","representative.name","balance","status"],showGridlines:""},{header:t(()=>[i("div",z,[a(r,{type:"button",icon:"pi pi-fw pi-pencil",label:"조사지 등록",outlined:"",onClick:o[0]||(o[0]=e=>V())}),a(_,null,{default:t(()=>[a(g,null,{default:t(()=>[...o[3]||(o[3]=[i("i",{class:"pi pi-search"},null,-1)])]),_:1}),a(p,{modelValue:d.value.global.value,"onUpdate:modelValue":o[1]||(o[1]=e=>d.value.global.value=e),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})])]),empty:t(()=>[...o[4]||(o[4]=[h(" No customers found. ",-1)])]),loading:t(()=>[...o[5]||(o[5]=[h(" Loading customers data. Please wait. ",-1)])]),default:t(()=>[a(c,{field:"name",header:"조사지ID",style:{"min-width":"12rem"}},{body:t(({data:e})=>[h(v(e.name),1)]),filter:t(({filterModel:e})=>[a(p,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,type:"text",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(c,{header:"조사지명",filterField:"country.name",style:{"min-width":"12rem"}},{body:t(({data:e})=>[i("div",X,[i("span",null,v(e.country.name),1)])]),filter:t(({filterModel:e})=>[a(p,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,type:"text",placeholder:"Search by country"},null,8,["modelValue","onUpdate:modelValue"])]),filterclear:t(({filterCallback:e})=>[a(r,{type:"button",icon:"pi pi-times",onClick:l=>e(),severity:"secondary"},null,8,["onClick"])]),filterapply:t(({filterCallback:e})=>[a(r,{type:"button",icon:"pi pi-check",onClick:l=>e(),severity:"success"},null,8,["onClick"])]),_:1}),a(c,{header:"작성자",filterField:"representative",showFilterMatchModes:!1,filterMenuStyle:{width:"14rem"},style:{"min-width":"14rem"}},{body:t(({data:e})=>[i("div",J,[i("span",null,v(e.representative.name),1)])]),filter:t(({filterModel:e})=>[a(x,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,options:b,optionLabel:"name",placeholder:"Any"},{option:t(l=>[i("div",Y,[i("span",null,v(l.option.name),1)])]),_:1},8,["modelValue","onUpdate:modelValue","options"])]),_:1}),a(c,{header:"최종 수정일",filterField:"date",dataType:"date",style:{"min-width":"10rem"}},{body:t(({data:e})=>[h(v(M(e.date)),1)]),filter:t(({filterModel:e})=>[a(U,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,dateFormat:"mm/dd/yy",placeholder:"mm/dd/yyyy"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(c,{header:"상세보기",style:{"min-width":"10rem"}},{body:t(({data:e})=>[a(K,{surveyId:e.id},null,8,["surveyId"])]),_:1})]),_:1},8,["filters","value","loading"])])}}},De=q(Z,[["__scopeId","data-v-c5973bc3"]]);export{De as default};
