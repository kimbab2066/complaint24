import{s as B,a as L}from"./index-DFkLlqX2.js";import{a0 as N,Z as P,X as f,a1 as V,e as p,p as u,g as a,ae as R,w as i,br as g,o as m,d as j,f as y,D as A,a3 as v}from"./index-CIvZqnG9.js";import{s as I}from"./index-BPbqiqrq.js";import{s as M}from"./index-C1RUL0yP.js";import"./index-B8K14yKN.js";import"./index-rSX_qRTu.js";import"./index-D3alGoI6.js";import"./index-CI70ECEq.js";import"./index-2HQD3IZ5.js";import"./index-Q5f-HasL.js";import"./index-DrWbS65R.js";import"./index-DtbhESyl.js";import"./index-ntJNSm1c.js";import"./index-CDHacQLo.js";import"./index-vf1YAX2A.js";import"./index-DRZUHWhE.js";import"./index-DaQCVIMN.js";import"./index-m-AAtQFb.js";const S={class:"dashboard-layout"},q={class:"main-content"},D={class:"table-container"},E={key:1,class:"text-green-500 font-bold",style:{display:"inline-block"}},H={key:2,class:"text-gray-500",style:{display:"inline-block"}},ie={__name:"CounselingHistory",setup(O){const _=N(),l=P(),n=f([]),d=f(!0);function b(t){switch(t){case"상담완료":return"success";case"예약확정":return"info";case"취소":return"danger";default:return"warning"}}async function h(){d.value=!0;try{const t=await g.getMyReservations();n.value=t.data}catch(t){console.error("예약 내역 로딩 실패:",t),l.add({severity:"danger",summary:"오류",detail:"예약 내역을 불러오는 데 실패했습니다.",life:3e3}),n.value=[]}finally{d.value=!1}}function w(t,e){_.require({target:t.currentTarget,message:`${e.dateTime} 예약을 취소하시겠습니까?`,icon:"pi pi-exclamation-triangle",acceptLabel:"예, 취소합니다",rejectLabel:"아니요",acceptClass:"p-button-danger",accept:()=>{C(e.id)},reject:()=>{l.add({severity:"info",summary:"알림",detail:"예약 취소가 보류되었습니다.",life:3e3})}})}async function C(t){var e,c;try{console.log(`API 호출: ${t}번 예약 취소`),await g.cancelReservation(t);const o=n.value.findIndex(r=>r.id===t);o!==-1&&(n.value[o].status="취소"),l.add({severity:"success",summary:"예약 취소",detail:"예약이 정상적으로 취소되었습니다.",life:3e3})}catch(o){console.error("예약 취소 실패:",o),l.add({severity:"danger",summary:"취소 실패",detail:((c=(e=o.response)==null?void 0:e.data)==null?void 0:c.message)||"예약 취소 중 오류가 발생했습니다.",life:3e3})}}return V(()=>{h()}),(t,e)=>{const c=M,o=R,r=L,k=I,x=A,T=B;return m(),p("div",S,[u("div",q,[e[2]||(e[2]=u("h1",{class:"page-title"},"상담 내역",-1)),e[3]||(e[3]=u("p",{class:"welcome-message"},"신청하신 상담 예약의 현재 상태입니다.",-1)),u("div",D,[a(c),a(o),a(T,{value:n.value,loading:d.value,responsiveLayout:"scroll",paginator:"",rows:10,rowsPerPageOptions:[5,10,20]},{empty:i(()=>[...e[0]||(e[0]=[v(" 신청하신 상담 내역이 없습니다. ",-1)])]),loading:i(()=>[...e[1]||(e[1]=[v(" 상담 내역을 불러오는 중입니다... ",-1)])]),default:i(()=>[a(r,{field:"dateTime",header:"상담일시",sortable:!0,style:{"min-width":"12rem"}}),a(r,{field:"staff",header:"담당자",style:{"min-width":"8rem"}}),a(r,{field:"status",header:"상태",style:{"min-width":"8rem"}},{body:i(({data:s})=>[a(k,{value:s.status==="상담완료"?"상담완료":s.status,severity:b(s.status)},null,8,["value","severity"])]),_:1}),a(r,{header:"관리",style:{"min-width":"8rem","text-align":"center"}},{body:i(({data:s})=>[s.status==="예약확정"?(m(),j(x,{key:0,label:"예약취소",class:"p-button-danger p-button-outlined p-button-sm",onClick:$=>w($,s)},null,8,["onClick"])):y("",!0),s.status==="상담완료"?(m(),p("span",E," 완료됨 ")):y("",!0),s.status==="취소"?(m(),p("span",H," 취소됨 ")):y("",!0)]),_:1})]),_:1},8,["value","loading"])])])])}}};export{ie as default};
