import{ax as T,X as p,a1 as $,e as m,o as l,p as o,d as f,g as s,w as r,a3 as j,t as N,f as S,D as E,j as F,aH as V,a2 as B,aF as y}from"./index-CIvZqnG9.js";import{a as I,s as U}from"./index-DFkLlqX2.js";import{s as L}from"./index-BPbqiqrq.js";import"./index-B8K14yKN.js";import"./index-rSX_qRTu.js";import"./index-D3alGoI6.js";import"./index-CI70ECEq.js";import"./index-2HQD3IZ5.js";import"./index-Q5f-HasL.js";import"./index-DrWbS65R.js";import"./index-DtbhESyl.js";import"./index-ntJNSm1c.js";import"./index-CDHacQLo.js";import"./index-vf1YAX2A.js";import"./index-DRZUHWhE.js";import"./index-DaQCVIMN.js";import"./index-m-AAtQFb.js";const M={class:"approval-page"},z={class:"table-container"},Y={key:0,class:"empty-list-message"},H={key:0,class:"flex gap-2 justify-center"},K={class:"p-fluid"},X={class:"field"},q={__name:"AdminApproval",setup(h){const c=p([]),n=p(!1),u=p(""),g=p(null),v=async()=>{try{const t=await y.get("/api/institutions/approval"),e=["USER","1a","STAFF","2a"];c.value=t.data.filter(i=>e.includes(i.role))}catch(t){console.error("권한 승인 대기 목록 오류",t)}},w=async t=>{if(confirm(`${t.user_name}의 권한 요청을 승인하시겠습니까?`))try{const e=await y.patch(`/api/institutions/approval/${t.user_id}`);console.log("승인 완료",e.data.message),await v()}catch(e){console.error("권한 승인 실패",e)}},x=t=>{g.value=t,u.value="",n.value=!0},b=t=>{if(!t)return"N/A";try{const e=new Date(t);return isNaN(e.getTime())?"유효하지 않은 날짜":e.toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"날짜 포맷 오류"}},k=t=>{switch(t){case"1a":case"USER":return"일반 이용자";case"2a":case"STAFF":return"기관 담당자";case"3a":case"ADMIN":return"기관 관리자";default:return t}},A=t=>{switch(t){case"READY":return"warning";case"ACTIVE":return"success";default:return"secondary"}};return $(()=>{v()}),(t,e)=>{const i=I,_=L,d=E,D=U,R=B;return l(),m("div",M,[e[5]||(e[5]=o("h2",{class:"page-subtitle"},"신규 관리자 및 담당자 승인 대기 목록",-1)),o("div",z,[c.value.length?(l(),f(D,{key:1,value:c.value,paginator:"",rows:10,class:"p-datatable-gridlines"},{default:r(()=>[s(i,{field:"user_name",header:"신청자명",style:{width:"15%","min-width":"120px"}}),s(i,{field:"institution_name",header:"소속기관",style:{width:"15%","min-width":"120px"}}),s(i,{field:"role",header:"요청권한",style:{width:"15%","min-width":"120px"}},{body:r(a=>[s(_,{value:k(a.data.role),severity:a.data.role.includes("3a")?"info":"secondary"},null,8,["value","severity"])]),_:1}),s(i,{field:"created_at",header:"신청일자",style:{width:"15%","min-width":"120px"}},{body:r(a=>[j(N(b(a.data.created_at)),1)]),_:1}),s(i,{field:"status",header:"상태",style:{width:"15%","min-width":"100px"}},{body:r(a=>[s(_,{value:a.data.status,severity:A(a.data.status)},null,8,["value","severity"])]),_:1}),s(i,{header:"처리",style:{width:"15%","min-width":"160px"},headerStyle:"text-align: center;"},{body:r(a=>[a.data.status==="READY"?(l(),m("div",H,[s(d,{icon:"pi pi-check",label:"승인",severity:"success",size:"small",onClick:C=>w(a.data)},null,8,["onClick"]),s(d,{icon:"pi pi-times",label:"반려",severity:"danger",size:"small",onClick:C=>x(a.data)},null,8,["onClick"])])):S("",!0)]),_:1})]),_:1},8,["value"])):(l(),m("div",Y,[...e[3]||(e[3]=[o("i",{class:"pi pi-check-circle"},null,-1),o("p",null,"현재 승인 대기 중인 사용자가 없습니다",-1)])])),s(R,{header:"권한 요청 반려 사유 입력",visible:n.value,"onUpdate:visible":e[2]||(e[2]=a=>n.value=a),modal:!0,class:"p-dialog-md",style:{width:"50vw"}},{footer:r(()=>[s(d,{label:"취소",icon:"pi pi-times",onClick:e[1]||(e[1]=a=>n.value=!1),text:"",raised:""}),s(d,{label:"전송",icon:"pi pi-check",onClick:t.submitReject,severity:"danger"},null,8,["onClick"])]),default:r(()=>[o("div",K,[o("div",X,[e[4]||(e[4]=o("label",{for:"rejectReason"},"반려 사유",-1)),F(o("textarea",{id:"rejectReason","onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),rows:"5",cols:"20",class:"p-inputtext p-component",placeholder:"상세 반려 사유 입력"},null,512),[[V,u.value]])])])]),_:1},8,["visible"])])])}}},G=T(q,[["__scopeId","data-v-c6b658b1"]]),pe={__name:"ApplicationForm",setup(h){return(c,n)=>(l(),f(G))}};export{pe as default};
