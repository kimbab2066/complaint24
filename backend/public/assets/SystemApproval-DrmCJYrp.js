import{ax as R,X as c,a1 as A,e as m,p as i,d as j,g as s,w as o,a2 as T,aF as _,o as d,a3 as $,t as N,f as S,D as V,j as B,aH as E}from"./index-CIvZqnG9.js";import{s as I,a as F}from"./index-DFkLlqX2.js";import{s as L}from"./index-BPbqiqrq.js";import"./index-B8K14yKN.js";import"./index-rSX_qRTu.js";import"./index-D3alGoI6.js";import"./index-CI70ECEq.js";import"./index-2HQD3IZ5.js";import"./index-Q5f-HasL.js";import"./index-DrWbS65R.js";import"./index-DtbhESyl.js";import"./index-ntJNSm1c.js";import"./index-CDHacQLo.js";import"./index-vf1YAX2A.js";import"./index-DRZUHWhE.js";import"./index-DaQCVIMN.js";import"./index-m-AAtQFb.js";const M={class:"approval-page"},U={class:"table-container"},z={key:0,class:"empty-list-message"},Y={key:0,class:"flex gap-2 justify-center"},H={class:"p-fluid"},K={class:"field"},X={__name:"SystemApproval",setup(q){const p=c([]),n=c(!1),u=c(""),f=c(null),v=async()=>{try{const t=await _.get("/api/institutions/approval");p.value=t.data}catch(t){console.error("권한 승인 대기 목록 오류",t)}},h=async t=>{if(confirm(`${t.user_name}의 권한 요청을 승인하시겠습니까?`))try{const e=await _.patch(`/api/institutions/approval/${t.user_id}`);console.log("승인 완료",e.data.message),await v()}catch(e){console.error("권한 승인 실패",e)}},g=t=>{f.value=t,u.value="",n.value=!0},w=t=>{if(!t)return"N/A";try{const e=new Date(t);return isNaN(e.getTime())?"유효하지 않은 날짜":e.toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return"날짜 포맷 오류"}},x=t=>{switch(t){case"1a":case"USER":return"일반 이용자";case"2a":case"STAFF":return"기관 담당자";case"3a":case"ADMIN":return"기관 관리자";default:return t}},b=t=>{switch(t){case"READY":return"warning";case"ACTIVE":return"success";default:return"secondary"}};return A(()=>{v()}),(t,e)=>{const r=F,y=L,l=V,k=I,D=T;return d(),m("div",M,[e[5]||(e[5]=i("h2",{class:"page-subtitle"},"신규 관리자 및 담당자 승인 대기 목록",-1)),i("div",U,[p.value.length?(d(),j(k,{key:1,value:p.value,paginator:"",rows:10,class:"p-datatable-gridlines"},{default:o(()=>[s(r,{field:"user_name",header:"신청자명",style:{width:"15%","min-width":"120px"}}),s(r,{field:"institution_name",header:"소속기관",style:{width:"15%","min-width":"120px"}}),s(r,{field:"role",header:"요청권한",style:{width:"15%","min-width":"120px"}},{body:o(a=>[s(y,{value:x(a.data.role),severity:a.data.role.includes("3a")?"info":"secondary"},null,8,["value","severity"])]),_:1}),s(r,{field:"created_at",header:"신청일자",style:{width:"15%","min-width":"120px"}},{body:o(a=>[$(N(w(a.data.created_at)),1)]),_:1}),s(r,{field:"status",header:"상태",style:{width:"15%","min-width":"100px"}},{body:o(a=>[s(y,{value:a.data.status,severity:b(a.data.status)},null,8,["value","severity"])]),_:1}),s(r,{header:"처리",style:{width:"15%","min-width":"160px"},headerStyle:"text-align: center;"},{body:o(a=>[a.data.status==="READY"?(d(),m("div",Y,[s(l,{icon:"pi pi-check",label:"승인",severity:"success",size:"small",onClick:C=>h(a.data)},null,8,["onClick"]),s(l,{icon:"pi pi-times",label:"반려",severity:"danger",size:"small",onClick:C=>g(a.data)},null,8,["onClick"])])):S("",!0)]),_:1})]),_:1},8,["value"])):(d(),m("div",z,[...e[3]||(e[3]=[i("i",{class:"pi pi-check-circle"},null,-1),i("p",null,"현재 승인 대기 중인 사용자가 없습니다",-1)])])),s(D,{header:"권한 요청 반려 사유 입력",visible:n.value,"onUpdate:visible":e[2]||(e[2]=a=>n.value=a),modal:!0,class:"p-dialog-md",style:{width:"50vw"}},{footer:o(()=>[s(l,{label:"취소",icon:"pi pi-times",onClick:e[1]||(e[1]=a=>n.value=!1),text:"",raised:""}),s(l,{label:"전송",icon:"pi pi-check",onClick:t.submitReject,severity:"danger"},null,8,["onClick"])]),default:o(()=>[i("div",H,[i("div",K,[e[4]||(e[4]=i("label",{for:"rejectReason"},"반려 사유",-1)),B(i("textarea",{id:"rejectReason","onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),rows:"5",cols:"20",class:"p-inputtext p-component",placeholder:"상세 반려 사유 입력"},null,512),[[E,u.value]])])])]),_:1},8,["visible"])])])}}},de=R(X,[["__scopeId","data-v-82dc6c19"]]);export{de as default};
